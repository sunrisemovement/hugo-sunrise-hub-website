{{ define "styles" }}
  {{ $homeCss := relURL "css/home.css" }}
  <link rel="stylesheet" href="{{ $homeCss }}" />
{{ end }}

{{ define "scripts" }}
  {{ $events := partialCached "get_home_events.html" . }}
  <script>
    window._data = window._data || {}
    window._data.events = {{ $events }}
    window._data.hubName = {{ $.Site.Data.settings.site.hubNameShort }}
  </script>
  <script type="module" src="/js/Home.js"></script>
{{ end }}

{{ define "main" }}
  <section
    class="top"
    id="top"
    style="--image:url('{{ .Params.top.image | relURL }}');">
    <div class="top-intro">
      <h1 class="top-hub-name">Sunrise {{ $.Site.Data.settings.site.hubNameShort }}</h1>
      <p class="top-details">{{ .Params.top.intro }}</p>
    </div>
  </section>
  <section
    id="about"
    class="about shared-main-section"
    >
    <h2 class="shared-section-header">About</h2>
    <div class="about-details">
      <div class="about-details-content">
        {{ .Params.about.details | markdownify }}
      </div>
    </div>
  </section>
  {{ $newsPages := where .Site.RegularPages "Section" "==" "news" }}
  {{ $newsCount := len $newsPages }}
  {{ $newsLatest := index $newsPages 0 }}
  {{ $newsOldest := index $newsPages (sub $newsCount 1) }}
  {{ if (gt $newsCount 0) }}
    <section
      id="news"
      class="news shared-main-section">
      <h2 class="shared-section-header">News</h2>
      <div class="news-container">
        <div class="news-latest shared-card">
          <div class="news-latest-inner shared-card-inner">
            <div class="news-latest-image" style="--image:url('{{ $newsLatest.Params.image | relURL }}')"></div>
            <div class="news-latest-info">
              <h3 class="news-latest-title">{{ $newsLatest.Params.title }}</h3>
              <p class="news-latest-preview">
                {{ $newsLatest.Params.content | truncate 200 }}
              </p>
              <div class="news-latest-actions">
                <
              </div>
            </div>
          </div>
        </div>
        <div class="news-summary">
          Sunrise
          {{ $.Site.Data.settings.site.hubNameShort }}
          has published
          <strong>{{ $newsCount }}</strong>
          {{ if (eq $newsCount 1) }}
            story
          {{ else }}
            stories
          {{ end }}
          since
          <strong>{{ $newsOldest.PublishDate.Format "January 2006" }}</strong>
        </div>
      </div>
    </section>
  {{ end }}

  {{ $events := partialCached "get_home_events.html" . }}
  <section
    id="events"
    class="events-interactive">
    <h2 class="shared-section-header">Events</h2>
    <sunrise-events></sunrise-events>
  </section>

  <noscript>
    <section
      id="events"
      class="events shared-main-section">
      <h2 class="shared-section-header events-header">
        Events
      </h2>
      <div class="events-scroller">
      {{ range $events }}
        <div class="shared-card events-container">
          {{ $coordinateStr := delimit (slice (string .location.coordinates.longitude) (string .location.coordinates.latitude)) "," }}
          {{ $baseMapParams := querify "access_token" "pk.eyJ1IjoibHVrZXdlc3RieSIsImEiOiJjanVrb3phNGsxeTdxNDNwZ2MybTQwNHl3In0.cD1c7AwcVaia7W4g-f5gLQ" }}
          {{ $mapUrl := delimit (slice "https://api.mapbox.com/styles/v1/mapbox/streets-v11/static/pin-s+000(" $coordinateStr ")/" $coordinateStr ",14,0,0/600x600?" $baseMapParams) "" }}
          <div class="shared-card-inner events-container-inner">
            <img class="events-map" src="{{ $mapUrl }}" />
            <h3 class="events-title">{{ .title }}</h3>
            <div class="events-icon">
              {{ partial "icon.html" "event" }}
            </div>
            <div class="events-detail-section">
              <p class="events-start-date">
                {{ dateFormat "January 2, 2006" .start }}
              </p>
              <p>
                {{ dateFormat "3:00pm" .start }} - {{ dateFormat "3:00pm" .end }}
              </p>
            </div>
            <div class="events-icon">
              {{ partial "icon.html" "place"}}
            </div>
            <div class="events-detail-section">
              <p class="events-location-name">
                {{ .location.name }}
              </p>
              <p>{{ .location.address }}</p>
            </div>
            {{ if .is_accessible }}
              <div class="events-icon">
                {{ partial "icon.html" "accessible"}}
              </div>
              <div class="events-detail-section">
                Wheelchair Accessible
              </div>
            {{ end }}
            <div class="events-icon">
              {{ partial "icon.html" "info"}}
            </div>
            <div class="events-detail-section events-info-details">
              {{ .details }}
            </div>
          </div>
        </div>
      {{ end }}
      </div>
    </section>
  </noscript>
{{ end }}